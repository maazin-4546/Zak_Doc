        const userPrompt = `You are an expert in document data extraction. Extract only the relevant fields from this invoice document and return a **valid JSON object**. The user may upload either a **multi-page PDF** or an **image (JPG, PNG, etc.)**, so ensure proper extraction of all details from the entire document.

        The invoice may be in **English, French, or Arabic**. Extract the required details accurately, regardless of the language, and always return them in **English** while preserving the correct numerical values.

        1️⃣ **General Fields**:
        - "invoice_number": The unique identifier assigned to the invoice or bill. This can be labeled as "Invoice Number," "Bill Number," "Receipt Number," or similar terms in **English ("Invoice No."), French ("Numéro de facture"), or Arabic ("رقم الفاتورة")**. It is typically found at the top of the invoice or near billing details.
        - "date": The official invoice date when the bill was issued. This should strictly refer to the "Invoice Date" and should not be confused with "Order Date," "Shipping Date," or "Due Date." The label may be in **English ("Invoice Date"), French ("Date de facture"), or Arabic ("تاريخ الفاتورة")**. It can appear in formats like **DD/MM/YYYY, MM/DD/YYYY**, or other standard date formats.
        - "company_name": The name of the business or entity that issued the bill. This is the **billing company** and not the vendor (seller) or customer. It may be labeled in **English ("Company Name"), French ("Nom de l'entreprise"), or Arabic ("اسم الشركة")**. It is usually found in the header section near the company's address and logo.
        - "vendor_name": The name of the individual or business purchasing the product or service. This may be labeled as **"Customer Name" (English), "Nom du client" (French), or "اسم العميل" (Arabic)**. It refers to the entity responsible for the payment and is usually located in the billing section of the invoice.
        - "tax_amount": The total tax applied to the invoice. This may be labeled as **"Tax Amount" (English), "Montant de la taxe" (French), or "مبلغ الضريبة" (Arabic)**. It can appear under multiple labels such as "GST," "VAT," "SGST," "CGST," or "Taxable Amount." If multiple tax types are present, extract them separately with corresponding labels (e.g., **SGST: 9%, CGST: 9%**).
        - "total": The final amount payable by the customer after adding all product prices and applicable taxes. This is often labeled as **"Grand Total" (English), "Montant total" (French), or "المبلغ الإجمالي" (Arabic)**. It is usually found at the bottom of the invoice in a bold or highlighted format.
        
        2️⃣ **Products Section**:
        - "products": A list of objects, each containing:
            - "product_name": The **exact product or service name** as mentioned on the invoice. It can be labeled as **"Item Name," "Product," "Service," "Description," or "Details."**  
              - **If a number appears at the end of a product name, do not treat it as a quantity.** It should be part of the product name unless explicitly listed in the "Quantity" column.
              - Example: "Service or Product Description 5" should be extracted as "Service or Product Description 5", and **not** as a product name "Service or Product Description" with quantity 5.  
            - "quantity": Extract the **number of units purchased** only from the **"Quantity" column.**  
              - **Do not infer quantity from product names.**  
              - Look for labels like **"Qty," "Quantity," "Units," "QTY," or similar terms.** In French, this may be **"Quantité," "Unité," or "Qté"**, and in Arabic, **"الكمية" or "عدد الوحدات"**.  
              - If no quantity is explicitly provided, return **null**.  
            - "unit_amount": The **price per unit of the product/service**. Extract from labels such as **"Unit Price," "Rate," "Per Item Cost," or "Price Each."**  
              - In French, this may be **"Prix unitaire"** or **"Tarif"**, and in Arabic **"سعر الوحدة"**.  
              - Ensure **numerical accuracy** and **exclude currency symbols** unless explicitly needed.  
            - "line_total": The **total price per product** (unit_amount × quantity). Extract from fields labeled **"Total," "Line Total," "Subtotal," "Amount," or "Price."**  
              - If missing, return **null**.  
            - If the invoice includes **discounts, taxes, or additional charges per product**, extract them as separate fields if present.  
            - **Ensure product listings are extracted from tables, structured item lists, or descriptions.** If a table is split across multiple pages, merge the extracted products into a single list.  
            - **If an invoice contains multiple sections (e.g., Itemized Products, Services, Additional Charges), extract all relevant product/service entries in the same "products" array.**  
            - **Avoid extracting headers, footers, totals, or non-product information.**  
        
        3️⃣ **Multi-Page PDF Handling**:
        - If the uploaded document is a **multi-page PDF**, extract relevant information from **all pages**.
        - Ensure that all fields (including "products") are collected across multiple pages, and **do not miss** any details due to page breaks.
        - Combine extracted details from different pages into a **single structured JSON object**.
        
        4️⃣ **Data Handling**:
        - If a field **does not exist**, return **null**.
        - **Ensure JSON validity**, no Markdown formatting.
        - Return data in **proper JSON format**, enclosed in curly braces { }.
        - If multiple products exist, return all in the "products" array.
        - Do **not** return unnecessary details.
        
        🚀 **Expected Output Example:**
        {
            "invoice_number": "INV-12345",
            "date": "2024-02-20",
            "company_name": "Saffron Design",
            "vendor_name": "Priya Chopra",
            "tax_amount": 1469.52,
            "total": 13715.52,
            "products": [
                { "product_name": "Frontend design restructure", "quantity": 1, "unit_amount": 9999 },
                { "product_name": "Backend API setup", "quantity": 2, "unit_amount": 3000 }
            ]
        }
        
        Return only JSON output with no explanations or additional text.`;



----------------------------------------------------------------------------------

        const userPrompt = `You are an expert in document data extraction. Extract only the relevant fields from this invoice document and return a **valid JSON object**. The user may upload either a **multi-page PDF** or an **image (JPG, PNG, etc.)**, so ensure proper extraction of all details from the entire document.

        The invoice may be in **English, French, or Arabic**. Extract the required details accurately, regardless of the language, and always return them in **English** while preserving the correct numerical values.
        
        1️⃣ **General Fields**:
        - "invoice_number": The unique identifier assigned to the invoice or bill. This can be labeled as "Invoice Number," "Bill Number," "Receipt Number," or similar terms in **English ("Invoice No."), French ("Numéro de facture"), or Arabic ("رقم الفاتورة")**. It is typically found at the top of the invoice or near billing details.
        - "date": The official invoice date when the bill was issued. This should strictly refer to the "Invoice Date" and should not be confused with "Order Date," "Shipping Date," or "Due Date." The label may be in **English ("Invoice Date"), French ("Date de facture"), or Arabic ("تاريخ الفاتورة")**. It can appear in formats like **DD/MM/YYYY, MM/DD/YYYY**, or other standard date formats.
        - "company_name": The name of the business or entity that issued the bill. This is the **billing company** and not the vendor (seller) or customer. It may be labeled in **English ("Company Name"), French ("Nom de l'entreprise"), or Arabic ("اسم الشركة")**. It is usually found in the header section near the company's address and logo.
        - "vendor_name": The name of the individual or business purchasing the product or service. This may be labeled as **"Customer Name" (English), "Nom du client" (French), or "اسم العميل" (Arabic)**. It refers to the entity responsible for the payment and is usually located in the billing section of the invoice.
        
        2️⃣ **Amount-Related Fields (Ensure Currency is Included in the Same Field)**:
        - "tax_amount": The total tax applied to the invoice. This may be labeled as **"Tax Amount" (English), "Montant de la taxe" (French), or "مبلغ الضريبة" (Arabic)**. It can appear under multiple labels such as "GST," "VAT," "SGST," "CGST," or "Taxable Amount." 
          - If multiple tax types are present, extract them separately with corresponding labels.  
          - **Example Output:**  
            "tax_amount": {  
                "SGST": "₹9",  
                "CGST": "$9"  
            }  
          - Ensure **amount values include currency within the same field** (e.g., "₹9" instead of separate amount and currency fields).  
        
        - "total": The final amount payable by the customer after adding all product prices and applicable taxes. This is often labeled as **"Grand Total" (English), "Montant total" (French), or "المبلغ الإجمالي" (Arabic)**. It is usually found at the bottom of the invoice in a bold or highlighted format.  
          - **Always extract the total amount as a single string including the currency.**  
          - **Example Output:**  
            "total": "₹13715.52"  
        
        3️⃣ **Products Section**:
        - "products": A list of objects, each containing:
            - "product_name": The **exact product or service name** as mentioned on the invoice. It can be labeled as **"Item Name," "Product," "Service," "Services," "Description," or "Details."**  
              - **If a number appears at the end of a product name, do not treat it as a quantity.** It should be part of the product name unless explicitly listed in the "Quantity" column.
            - "quantity": Extract the **number of units purchased** only from the **"Quantity" column.**  
              - If no quantity is explicitly provided, return **null**.  
            - "unit_amount": The **price per unit of the product/service**. Extract from labels such as **"Unit Price," "Rate," "Per Item Cost," or "Price Each."**  
              - Ensure **amount includes the currency within the same field** (e.g., "$9999").  
              - **Example Output:**  
                "unit_amount": "$9999"  
            - "line_total": The **total price per product** (unit_amount × quantity). Extract from fields labeled **"Total," "Line Total," "Subtotal," "Amount," or "Price."**  
              - If missing, return **null**.  
            - If the invoice includes **discounts, taxes, or additional charges per product**, extract them as separate fields if present.  
            - **Ensure product listings are extracted from tables, structured item lists, or descriptions.**  
        
        4️⃣ **Multi-Page PDF Handling**:
        - If the uploaded document is a **multi-page PDF**, extract relevant information from **all pages**.
        - Ensure that all fields (including "products") are collected across multiple pages, and **do not miss** any details due to page breaks.
        - Combine extracted details from different pages into a **single structured JSON object**.
        
        5️⃣ **Data Handling**:
        - If a field **does not exist**, return **null**.
        - **Ensure JSON validity**, no Markdown formatting.
        - Return data in **proper JSON format**, enclosed in curly braces { }.
        - If multiple products exist, return all in the "products" array.
        - Do **not** return unnecessary details.
        
        🚀 **Expected Output Example:**
        {
            "invoice_number": "INV-12345",
            "date": "2024-02-20",
            "company_name": "Saffron Design",
            "vendor_name": "Priya Chopra",
            "tax_amount": {
                "SGST": "₹9",
                "CGST": "$9"
            },
            "total": "₹13715.52",
            "products": [
                { "product_name": "Frontend design restructure", "quantity": 1, "unit_amount": "$9999" },
                { "product_name": "Backend API setup", "quantity": 2, "unit_amount": "€3000" }
            ]
        }
        
        Return only JSON output with no explanations or additional text.
        
        **Text Input:** ${pdfText}`;